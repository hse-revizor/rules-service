# Сервис управления правилами

Этот сервис предоставляет API для управления правилами. Правила определяют ожидаемое поведение системы и хранятся в базе данных PostgreSQL.

## Описание сущностей

### Rule (Правило)

| Поле          | Тип         | Описание                                          |
|---------------|-------------|---------------------------------------------------|
| `Id`          | `uuid.UUID` | Уникальный идентификатор правила (первичный ключ) |
| `TypeId`      | `string`    | Тип правила                                       |
| `Params`      | `string`    | Параметры правила                                 |
| `CreatedAt`   | `time.Time` | Время создания правила                            |
| `UpdatedAt`   | `time.Time` | Время последнего обновления правила               |

### Policy (Политика)

| Поле          | Тип         | Описание                                           |
|---------------|-------------|---------------------------------------------------|
| `Id`          | `uuid.UUID` | Уникальный идентификатор политики (первичный ключ)|
| `ProjectID`   | `string`    | Идентификатор проекта                             |
| `RulesIDs`    | `[]string`  | Массив идентификаторов правил                     |
| `CreatedAt`   | `time.Time` | Время создания политики                           |
| `UpdatedAt`   | `time.Time` | Время последнего обновления политики              |

## Используемые технологии

*   **Язык программирования:** Go
*   **База данных:** PostgreSQL
*   **HTTP-роутер:** Gin-gonic
*   **ORM:** GORM
*   **Генерация документации:** Swaggo

## Запуск приложения

### Требования

*   Установленный Go (версия 1.18 или выше)
*   Установленный PostgreSQL
*   Настроенное подключение к базе данных PostgreSQL (см. `config.yaml`)

### Команды Makefile

*   **`run-dev`**: Запускает приложение в режиме разработки.
    *   Использует конфигурационный файл `config.yaml`.
    *   Устанавливает переменную окружения `env-mode` в `development`.
*   **`swag`**: Генерирует документацию API с помощью Swaggo.
    *   `--parseDependency`: Включает парсинг зависимостей.
    *   `--parseInternal`: Включает парсинг внутренних пакетов.
    *   `--parseDepth 3`: Устанавливает глубину парсинга зависимостей на 3 уровня.
    *   `-g cmd/service/main.go`: Указывает главный файл приложения.

### Запуск в режиме разработки

1.  **Настройте подключение к базе данных:**
    *   Создайте базу данных PostgreSQL.
    *   Обновите параметры подключения в файле `config.yaml` (например, имя пользователя, пароль, имя базы данных).
2.  **Запустите приложение:**

    ```bash
    make run-dev
    ```
    Сервис будет доступен по адресу `http://localhost:8080` (порт может быть изменен в `config.yaml`).

## Документация API

Документация API генерируется автоматически с помощью Swaggo и доступна по адресу `http://localhost:8080/swagger/index.html` (после запуска приложения и выполнения `make swag`).

## Функциональность

Сервис предоставляет следующие возможности:

*   **Создание правил:** Добавление новых правил в систему.
*   **Получение правил:** Получение списка правил или конкретного правила по его ID.
*   **Обновление правил:** Изменение существующих правил.
*   **Удаление правил:** Удаление правил из системы.

## Конфигурация

Конфигурация приложения осуществляется через файл `config.yaml`. В нем можно настроить:

*   Параметры подключения к базе данных.
*   Порт, на котором запускается сервис.
*   Другие параметры, специфичные для приложения.
---
    Port: Порт, на котором запускается сервис
    Host: Хост сервиса
    DB:
        Host: хост базы данных
        Port: порт базы данных
        Username: пользователь базы данных
        Name: название базы данных
        Password: пароль для пользователя базы данных
        SSLMode: тип SSL-соединения (например, `disable`, `require`, `verify-ca`, `verify-full`)
---


## Внесение изменений

При изменении модели данных (`Rule`) или API необходимо:

1.  Обновить структуру `Rule` в коде.
2.  Обновить миграции базы данных, если необходимо.
3.  Обновить документацию API, выполнив команду `make swag`.

## Примечание
* Замените порт `8080`